{% extends "base.html" %}

{% block breadcrumb %}
<div class="container">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
            <li class="breadcrumb-item"><a href="#">Users</a></li>
            <li class="breadcrumb-item active" aria-current="page">Home</li>
        </ol>
    </nav>
</div>
{% endblock %}

{% block content %}
{% include "modal.html" %}

<div class="container">
    <section class="user">
        <div class="row">
            <img src="{{ url_for('static', filename='images/1.jpg') }}" alt=""
                class="img-responsive profile-background">
            <div class="user-profile">
                <img src="{{ url_for('static', filename='images/2.jpg') }}" alt="" class="profile-image">
                <div class="user-text-wrapper">
                    <h1>@{{ user.display_name }}</h1>
                    <h4>{{ user.first_name }} {{ user.last_name }}</h4>
                </div>

                {% if not current_user == user and current_user.is_authenticated %}
                {% if not current_user.is_following(user) %}
                <form action="{{ url_for('follow', username=user.username) }}" method="post">
                    {{ form.hidden_tag() }}

                    {{ form.submit(value='Follow', class='btn btn-info') }}
                </form>
                {% else %}
                <form action="{{ url_for('unfollow', username=user.username) }}" method="post">
                    {{ form.hidden_tag() }}

                    {{ form.submit(value='Unfollow', class='btn btn-info') }}
                </form>
                {% endif %}
                {% endif %}
            </div>
        </div>
        <div class="row">
            <!--div class="col-md-4">
                {% if user == current_user %}
                    <form action="{{ url_for('upload.upload_file') }}" method="post" enctype="multipart/form-data">
                        {{ form.hidden_tag() }}
    
                        <div class="form-group">
                            {{ form.file.label }}<br>
                            {{ form.file() }}<br>
                            {% for error in form.file.errors %}
                            <span class="color:red;">{{ error }}</span>
                            {% endfor %}
                        </div>
                        <p>{{ form.submit(class='btn btn-primary') }}</p>
                    </form>
                {% endif %}
            </div-->
            <div class="col-lg-6 col-md-8 col-sm-1">
                <div class="profile-nav">
                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" id="pills-about-tab" data-toggle="pill" href="#pills-about"
                                role="tab" aria-controls="pills-about" aria-selected="true">About Me</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="pills-followers-tab" data-toggle="pill" href="#pills-followers"
                                role="tab" aria-controls="pills-followers" aria-selected="false">Followers
                                ({{ user.followers.count() }})</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="pills-following-tab" data-toggle="pill" href="#pills-following"
                                role="tab" aria-controls="pills-following" aria-selected="false">Following
                                ({{ user.followed.count() }})</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="pills-photos-tab" data-toggle="pill" href="#pills-photos" role="tab"
                                aria-controls="pills-photos" aria-selected="false">Photos</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="btn btn-light" href="#">Message</button>
                        </li>
                    </ul>
                </div>
            </div>

        </div>

        <div class="row">
            <!-- start -->
            <div class="col-lg-9">


                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-about" role="tabpanel"
                        aria-labelledby="pills-about-tab">
                        <div class="pane-content">
                            <h3>About {{ user.first_name }}</h3>
                            <p><strong>Joined:</strong> {{ moment(user.created_at).format('LL') }}</p>
                            <p><strong>Last Seen:</strong> {{ moment(user.last_seen).format('LLL') }}</p>
                            {% if user.about_me %}
                                <p>{{ user.about_me }}</p>
                            {% else %}
                                <p>This user has not added a biography</p>
                            {% endif %}
                            {% if user == current_user %}<button class="btn btn-secondary" data-toggle="modal" data-target="#formModal" data-formaction="{{ edit_about_me }}">Edit</button>{% endif %}
                        </div>
                    </div>
                    <div class="tab-pane fade" id="pills-followers" role="tabpanel"
                        aria-labelledby="pills-followers-tab">
                        <div class="pane-content">
                            <h3>{{ user.first_name }}'s followers</h3>
                            <div class="row">
                                {% for follower in user.followers %}
                                <div class="user-image-link small">
                                    <a href="{{ url_for('user', username=follower.username) }}">
                                        <img class="media-image medium"
                                            src="{{ url_for('static', filename='images/3.jpg') }}" alt="">
                                        <h5>@{{ follower.display_name }}</h5>
                                    </a>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="pills-following" role="tabpanel"
                        aria-labelledby="pills-following-tab">
                        <div class="pane-content">
                            <h3>Who {{ user.first_name }} follows</h3>
                            <div class="row">
                                {% for follower in user.followed %}
                                <div class="user-image-link">
                                    <a href="{{ url_for('user', username=follower.username) }}">
                                        <img class="media-image medium"
                                            src="{{ url_for('static', filename='images/3.jpg') }}" alt="">
                                        <h5>@{{ follower.display_name }}</h5>
                                    </a>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="pills-photos" role="tabpanel" aria-labelledby="pills-photos-tab">
                        <div class="pane-content">
                            <h3>Photos</h3>
                            <div class="row">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3">
                <h2>Recent Activity</h2>
                <ul class="list-unstyled">
                    <li class="media">
                        <img src="..." class="mr-3" alt="...">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">This user liked another user's post</h5>
                        </div>
                    </li>
                    <li class="media my-4">
                        <img src="..." class="mr-3" alt="...">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">Uploaded new post</h5>
                        </div>
                    </li>
                    <li class="media">
                        <img src="..." class="mr-3" alt="...">
                        <div class="media-body">
                            <h5 class="mt-0 mb-1">List-based media object</h5>
                        </div>
                    </li>
                </ul>

                <a href="#" class="btn btn-primary">See all recent activity</a>
            </div>
            <!-- end -->
        </div>
    </section>

    <h2>{{ user.first_name }}'s posts</h2>
    <div class="row">
        {% for post in posts %}
        <div class="col-md-12">
            {% include "_post.html" %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}